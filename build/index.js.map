{"version":3,"sources":["webpack://SimpleExpress/webpack/universalModuleDefinition","webpack://SimpleExpress/external {\"root\":\"BodyParser\",\"commonjs2\":\"body-parser\",\"commonjs\":\"body-parser\",\"amd\":\"body-parser\"}","webpack://SimpleExpress/external {\"root\":\"CookieParser\",\"commonjs2\":\"cookie-parser\",\"commonjs\":\"cookie-parser\",\"amd\":\"cookie-parser\"}","webpack://SimpleExpress/external {\"root\":\"Cors\",\"commonjs2\":\"cors\",\"commonjs\":\"cors\",\"amd\":\"cors\"}","webpack://SimpleExpress/external {\"root\":\"Debug\",\"commonjs2\":\"debug\",\"commonjs\":\"debug\",\"amd\":\"debug\"}","webpack://SimpleExpress/external {\"root\":\"Express\",\"commonjs2\":\"express\",\"commonjs\":\"express\",\"amd\":\"express\"}","webpack://SimpleExpress/external {\"root\":\"_\",\"commonjs2\":\"lodash\",\"commonjs\":\"lodash\",\"amd\":\"lodash\"}","webpack://SimpleExpress/webpack/bootstrap","webpack://SimpleExpress/webpack/runtime/compat get default export","webpack://SimpleExpress/webpack/runtime/define property getters","webpack://SimpleExpress/webpack/runtime/hasOwnProperty shorthand","webpack://SimpleExpress/webpack/runtime/make namespace object","webpack://SimpleExpress/./src/lib/log.js","webpack://SimpleExpress/./src/lib/stats.js","webpack://SimpleExpress/./src/lib/buildRoutes.js","webpack://SimpleExpress/./src/lib/getResponseMethod.js","webpack://SimpleExpress/./src/lib/sendResponse.js","webpack://SimpleExpress/./src/lib/async.js","webpack://SimpleExpress/./src/lib/pluginUtils.js","webpack://SimpleExpress/./src/lib/createHandler.js","webpack://SimpleExpress/./src/lib/checkPropTypes.js","webpack://SimpleExpress/./src/lib/handleError.js","webpack://SimpleExpress/./src/lib/index.js","webpack://SimpleExpress/./src/lib/propTypesMiddleware.js"],"names":["root","factory","exports","module","require","define","amd","this","__WEBPACK_EXTERNAL_MODULE__539__","__WEBPACK_EXTERNAL_MODULE__791__","__WEBPACK_EXTERNAL_MODULE__308__","__WEBPACK_EXTERNAL_MODULE__540__","__WEBPACK_EXTERNAL_MODULE__686__","__WEBPACK_EXTERNAL_MODULE__460__","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","n","getter","__esModule","d","a","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag","value","log","debug","request","stats","warning","port","counters","events","addToList","category","field","data","push","statsInstance","set","number","add","getCounter","registerEvent","eventName","numberOfHandlers","timestamp","Date","now","getEvents","logStartup","logMessages","length","join","logDefaultMiddlewares","mappedRoutes","Set","mappedMethods","registeringRoute","forEach","routeEvent","path","method","names","invalidRoute","indexOf","foundNames","name","defaultRouterOptions","mergeParams","methodsRecognized","normalizePath","paths","map","index","_","filter","el","joinPath","attach","router","handlers","first","rest","createHandlerWithParams","routesAgregator","routes","registerRoute","handler","pathNormalized","methodNormalized","toLowerCase","mapMethod","toString","logRoute","logRoutes","getRoutes","getRoutesAgregator","createRouter","subPath","subRouter","Router","subEl","subKey","includes","Array","isArray","firstElement","responseMethods","default","json","send","none","body","req","res","result","headersSent","status","redirect","headers","type","responseMethod","getResponseMethod","requestTiming","protocol","originalUrl","forEachSequential","collection","cb","initialValue","results","previousResult","lastResult","chainPlugins","plugins","breakCondition","param","plugin","createHandler","simpleExpress","additionalParams","next","query","params","xhr","headerName","getHeader","locals","handlerParams","Error","mappedResult","sendResponse","createErrorHandler","error","Function","bind","typeSpecs","values","location","componentName","getStack","getArgs","args","reduce","accu","errorInstance","handleError","errorClass","errorHandler","validateErrorClass","validateHandler","errorHandlers","checkPropTypes","rules","errors","toUpperCase","cookies","ValidationError","defaultAppValue","defaultServerValue","getDefaultConfig","userConfig","defaultConfig","cors","jsonBodyParser","cookieParser","createSimpleExpressHelper","routeParams","runRoute","label","Promise","reject","route","wrapMiddleware","middleware","rawPlugins","middlewares","simpleExpressMiddlewares","globalMiddlewares","expressMiddlewares","expressMiddleware","config","app","userApp","server","userServer","simpleExpressConfigForPlugins","getStats","express","http","simpleExpressHelper","use","bodyParser","createErrorHandlerWithParams","expressMiddlewareFlat","middlewareFlat","buildRoutes","errorHandlersFlat","listen","address"],"mappings":"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","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"body-parser\"), require(\"cookie-parser\"), require(\"cors\"), require(\"debug\"), require(\"express\"), require(\"lodash\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"body-parser\", \"cookie-parser\", \"cors\", \"debug\", \"express\", \"lodash\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"SimpleExpress\"] = factory(require(\"body-parser\"), require(\"cookie-parser\"), require(\"cors\"), require(\"debug\"), require(\"express\"), require(\"lodash\"));\n\telse\n\t\troot[\"SimpleExpress\"] = factory(root[\"BodyParser\"], root[\"CookieParser\"], root[\"Cors\"], root[\"Debug\"], root[\"Express\"], root[\"_\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE__539__, __WEBPACK_EXTERNAL_MODULE__791__, __WEBPACK_EXTERNAL_MODULE__308__, __WEBPACK_EXTERNAL_MODULE__540__, __WEBPACK_EXTERNAL_MODULE__686__, __WEBPACK_EXTERNAL_MODULE__460__) {\nreturn ","module.exports = __WEBPACK_EXTERNAL_MODULE__539__;","module.exports = __WEBPACK_EXTERNAL_MODULE__791__;","module.exports = __WEBPACK_EXTERNAL_MODULE__308__;","module.exports = __WEBPACK_EXTERNAL_MODULE__540__;","module.exports = __WEBPACK_EXTERNAL_MODULE__686__;","module.exports = __WEBPACK_EXTERNAL_MODULE__460__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import debug from \"debug\";\n\n// prepare loggers using DEBUG utility\nconst log = debug(\"simpleExpress\");\nlog.request = debug(\"simpleExpress:request\");\nlog.stats = debug(\"simpleExpress:stats\");\nlog.warning = debug(\"simpleExpress:warning\");\n\nexport default log;\n","import log from \"./log\";\n\nconst getStats = (port) => {\n  const stats = {\n    counters: {},\n    events: {},\n  };\n\n  const addToList = (category, field, data) => {\n    if (!stats[category]) {\n      stats[category] = {};\n    }\n\n    if (!stats[category][field]) {\n      stats[category][field] = [];\n    }\n\n    stats[category][field].push(data);\n  };\n\n  const logDefaultMiddlewares = (statsInstance) => {\n    const logMessages = [];\n    if (statsInstance.getCounter(\"cors\")) {\n      logMessages.push(\"cors\");\n    }\n    if (statsInstance.getCounter(\"jsonBodyParser\")) {\n      logMessages.push(\"bodyParser.json\");\n    }\n    if (statsInstance.getCounter(\"cookieParser\")) {\n      logMessages.push(\"cookie-parser\");\n    }\n\n    if (logMessages.length) {\n      log.stats(`  Used built-in middlewares: ${logMessages.join(\", \")}`);\n    }\n  };\n\n  const statsInstance = {\n    set: (field, number = 1) => (stats.counters[field] = number),\n    add: (field, number = 1) =>\n      (stats.counters[field] = stats.counters[field]\n        ? stats.counters[field] + number\n        : number),\n    getCounter: (field) => stats.counters[field],\n    registerEvent: (eventName, data) => {\n      switch (eventName) {\n        case \"registeringRoute\":\n          statsInstance.add(\"routes\");\n          statsInstance.add(\"routeHandlers\", data.numberOfHandlers);\n          addToList(\"events\", eventName, { timestamp: Date.now(), ...data });\n          break;\n        default:\n          addToList(\"events\", eventName, { timestamp: Date.now(), ...data });\n      }\n    },\n    getEvents: (eventName) => stats.events[eventName],\n    logStartup: () => {\n      if (port) {\n        log.stats(`-->Stats for simpleExpress app on ${port} port:<--`);\n      } else {\n        log.stats(`-->Stats for simpleExpress app (no port):<--`);\n      }\n      logDefaultMiddlewares(statsInstance);\n      if (statsInstance.getCounter(\"expressMiddleware\")) {\n        log.stats(\n          `  Registered ${statsInstance.getCounter(\n            \"expressMiddleware\"\n          )} expressMiddleware${\n            statsInstance.getCounter(\"expressMiddleware\") > 1 ? \"s\" : \"\"\n          }`\n        );\n      }\n      if (statsInstance.getCounter(\"middleware\")) {\n        log.stats(\n          `  Registered ${statsInstance.getCounter(\"middleware\")} middleware${\n            statsInstance.getCounter(\"middleware\") > 1 ? \"s\" : \"\"\n          }`\n        );\n      }\n      if (statsInstance.getCounter(\"errorHandlers\")) {\n        log.stats(\n          `  Registered ${statsInstance.getCounter(\n            \"errorHandlers\"\n          )} errorHandlers${\n            statsInstance.getCounter(\"errorHandlers\") > 1 ? \"s\" : \"\"\n          }`\n        );\n      }\n\n      if (!statsInstance.getCounter(\"routes\")) {\n        return log.stats(`  No routes registered`);\n      }\n      log.stats(\n        `  Registered ${statsInstance.getCounter(\n          \"routes\"\n        )} routes with ${statsInstance.getCounter(\"routeHandlers\")} handlers:`\n      );\n      const mappedRoutes = new Set();\n      const mappedMethods = {};\n\n      stats.events.registeringRoute.forEach((routeEvent) => {\n        const { path, method, numberOfHandlers, names } = routeEvent;\n        if (!mappedMethods[path]) {\n          mappedMethods[path] = [];\n        }\n        mappedMethods[path].push({ method, numberOfHandlers, names });\n        mappedRoutes.add(path);\n      });\n\n      mappedRoutes.forEach((path) => {\n        const invalidRoute = path.indexOf(\"/\") !== 0 && path !== \"*\";\n        log.stats(\n          `    ${path}${\n            invalidRoute ? ' - WARNING: Route not starting with \"/\"!' : \"\"\n          }`\n        );\n        mappedMethods[path].forEach(\n          ({ method, numberOfHandlers, names = [] }) => {\n            let foundNames = false;\n            names.forEach((name) => {\n              if (name !== \"anonymous\") {\n                foundNames = true;\n              }\n            });\n            log.stats(\n              `      ${method}${\n                numberOfHandlers > 1 || foundNames\n                  ? `, ${numberOfHandlers} handler${\n                      numberOfHandlers === 1 ? \"\" : \"s\"\n                    }`\n                  : \"\"\n              }${\n                names && names.length && foundNames\n                  ? `: ${names.join(\", \")}`\n                  : \"\"\n              }`\n            );\n          }\n        );\n      });\n    },\n  };\n\n  return statsInstance;\n};\n\nexport default getStats;\n","import { Router } from \"express\";\nimport _ from \"lodash\";\n\nconst defaultRouterOptions = {\n  mergeParams: true,\n};\n\nconst methodsRecognized = [\n  \"use\",\n\n  \"get\",\n  \"post\",\n  \"put\",\n  \"delete\",\n  \"del\",\n  \"options\",\n  \"patch\",\n  \"head\",\n\n  \"checkout\",\n  \"copy\",\n  \"lock\",\n  \"merge\",\n  \"mkactivity\",\n  \"mkcol\",\n  \"move\",\n  \"m-search\",\n  \"notify\",\n  \"purge\",\n  \"report\",\n  \"search\",\n  \"subscribe\",\n  \"trace\",\n  \"unlock\",\n  \"unsubscribe\",\n];\n\nconst mapMethod = (method) => method.toLowerCase();\n\nconst normalizePath = (...paths) => {\n  return paths\n    .map((path, index) => {\n      if (!path) {\n        return \"\";\n      }\n      if (index === 0 && index === paths.length - 1) {\n        return path;\n      }\n      if (index === 0) {\n        return _.trimEnd(path, \"/\");\n      }\n      if (index === paths.length - 1) {\n        return _.trimStart(path, \"/\");\n      }\n      return _.trim(path, \"/\");\n    })\n    .filter((el) => el);\n};\n\nconst joinPath = (...paths) => {\n  return normalizePath(...paths).join(\"/\");\n};\n\nconst getRoutesAgregator = ({ stats }) => {\n  const routes = {};\n\n  const routesAgregator = {\n    registerRoute: ({ path, method, handler }) => {\n      const pathNormalized = normalizePath(path);\n      const methodNormalized = method ? mapMethod(method) : \"use (middleware)\";\n\n      _.set(routes, [...pathNormalized, method, \"path\"], path);\n      _.set(routes, [...pathNormalized, method, \"method\"], methodNormalized);\n      _.set(\n        routes,\n        [...pathNormalized, method, \"numberOfHandlers\"],\n        _.get(routes, [...pathNormalized, \"numberOfHandlers\"], 0) + 1\n      );\n      _.set(\n        routes,\n        [...pathNormalized, method, \"names\"],\n        [\n          ..._.get(routes, [...pathNormalized, \"names\"], []),\n          !handler.name || handler.name === method ? \"anonymous\" : handler.name,\n        ]\n      );\n      _.set(\n        routes,\n        [...pathNormalized, method, \"handlers\"],\n        [\n          ..._.get(routes, [...pathNormalized, \"handlers\"], []),\n          handler.toString(),\n        ]\n      );\n    },\n    logRoute: (routes) => {\n      if (routes.path) {\n        return stats.registerEvent(\"registeringRoute\", {\n          path: joinPath(...routes.path),\n          method: routes.method,\n          numberOfHandlers: routes.numberOfHandlers,\n          names: routes.names,\n        });\n      }\n      _.forEach(routes, routesAgregator.logRoute);\n    },\n    logRoutes: () => {\n      routesAgregator.logRoute(routes);\n    },\n    getRoutes: () => routes,\n  };\n\n  return routesAgregator;\n};\n\nconst attach =\n  (router) =>\n  (method, ...handlers) => {\n    const [first, ...rest] = handlers;\n    if (typeof first === \"string\") {\n      return router[method](first, ...rest);\n    }\n    return router[method](\"/\", ...handlers);\n  };\n\nconst getBuildRoutes = ({ stats, createHandlerWithParams }) => {\n  const routesAgregator = getRoutesAgregator({ stats });\n\n  const createRouter = (el, { subPath = [], method } = {}) => {\n    if (_.isFunction(el)) {\n      routesAgregator.registerRoute({ path: subPath, method, handler: el });\n      return createHandlerWithParams(el);\n    }\n\n    const subRouter = Router(defaultRouterOptions);\n\n    if (_.isPlainObject(el)) {\n      const { path, handlers, routes, ...rest } = el;\n      if (path) {\n        if (!handlers && !routes) {\n          attach(subRouter)(\n            \"use\",\n            path,\n            createRouter(rest, { subPath: [...subPath, path], method })\n          );\n        }\n        if (handlers) {\n          attach(subRouter)(\n            \"use\",\n            path,\n            createRouter(handlers, { subPath: [...subPath, path], method })\n          );\n        }\n        if (routes) {\n          attach(subRouter)(\n            \"use\",\n            path,\n            createRouter(routes, { subPath: [...subPath, path], method })\n          );\n        }\n      } else {\n        _.forEach(el, (subEl, subKey) => {\n          if (methodsRecognized.includes(subKey)) {\n            attach(subRouter)(\n              subKey,\n              createRouter(subEl, { subPath, method: subKey })\n            );\n          } else {\n            attach(subRouter)(\n              \"use\",\n              subKey,\n              createRouter(subEl, { subPath: [...subPath, subKey], method })\n            );\n          }\n        });\n      }\n    }\n    if (Array.isArray(el)) {\n      const [firstElement, ...rest] = el;\n      if (typeof firstElement === \"string\") {\n        attach(subRouter)(\n          \"use\",\n          firstElement,\n          createRouter(rest, { subPath: [...subPath, firstElement], method })\n        );\n      } else {\n        el.forEach((subEl) => {\n          attach(subRouter)(\"use\", createRouter(subEl, { subPath, method }));\n        });\n      }\n    }\n\n    return subRouter;\n  };\n\n  return (routes) => {\n    const router = createRouter(routes);\n    routesAgregator.logRoutes();\n    return router;\n  };\n};\n\nexport default getBuildRoutes;\n","export const responseMethods = {\n  default: \"send\",\n  json: \"json\",\n  send: \"send\",\n  none: null,\n};\n\nconst getResponseMethod = (method, body) => {\n  if (!method || !responseMethods.hasOwnProperty(method)) {\n    return responseMethods.default;\n  }\n  return responseMethods[method];\n};\n\nexport default getResponseMethod;\n","import log from \"./log\";\nimport getResponseMethod from \"./getResponseMethod\";\n\nconst sendResponse = (req, res, result) => {\n  if (!result) {\n    return;\n  }\n\n  if (res.headersSent) {\n    return log(\"ERROR: Headers have already been sent\");\n  }\n\n  const {\n    body = null,\n    status,\n    method,\n    redirect = false,\n    headers = null,\n    type = null,\n  } = result;\n\n  const responseMethod = getResponseMethod(method, body);\n  if (responseMethod) {\n    if (type) {\n      res.type(type);\n    }\n\n    if (headers) {\n      res.set(headers);\n    }\n\n    if (redirect) {\n      if (status) {\n        res.redirect(status, redirect);\n      } else {\n        res.redirect(redirect);\n      }\n      log.request(\n        `Request ended with redirect after ${\n          Date.now() - req.requestTiming\n        }ms; ${req.protocol}, ${req.originalUrl}${\n          status && `, status: ${status}`\n        }`\n      );\n    } else {\n      log.request(\n        `Request ended with response after ${\n          Date.now() - req.requestTiming\n        }ms; ${req.protocol}, ${req.originalUrl}, status: ${status || 200}`\n      );\n      res.status(status || 200)[responseMethod](body);\n    }\n  }\n};\n\nexport default sendResponse;\n","export const forEachSequential = async (collection, cb, initialValue) => {\n  const results = [];\n  let previousResult = initialValue;\n\n  for (const key in collection) {\n    if (collection.hasOwnProperty(key)) {\n      previousResult = await cb(collection[key], key, previousResult);\n      results.push(previousResult);\n    }\n  }\n\n  return { lastResult: previousResult, results };\n};\n\nexport const forEachParallel = async (arr, cb) => Promise.all(arr.map(cb));\n","import { forEachSequential } from \"./async\";\n\nexport const chainPlugins =\n  (plugins, method, breakCondition = () => false) =>\n  async (param, ...rest) => {\n    const { lastResult } = await forEachSequential(\n      plugins,\n      (plugin, index, previousResult) => {\n        if (plugin[method] && !breakCondition(previousResult)) {\n          return plugin[method](previousResult, ...rest);\n        }\n        return previousResult;\n      },\n      param\n    );\n    return lastResult;\n  };\n","import sendResponse from \"./sendResponse\";\nimport { chainPlugins } from \"./pluginUtils\";\nimport log from \"./log\";\n\nexport const createHandler =\n  ({ additionalParams = {}, plugins }, simpleExpress) =>\n  (handler) =>\n  async (req, res, next) => {\n    let result;\n\n    if (!req.requestTiming) {\n      req.requestTiming = Date.now();\n      log.request(\n        `Request started ${req.requestTiming}ms, ${req.protocol}, ${req.originalUrl}`\n      );\n    }\n\n    const handlerParams = await chainPlugins(\n      plugins,\n      \"getHandlerParams\"\n    )({\n      body: req.body,\n      query: req.query,\n      params: req.params,\n      method: req.method,\n      originalUrl: req.originalUrl,\n      protocol: req.protocol,\n      xhr: req.xhr,\n      get: (headerName) => req.get(headerName),\n      getHeader: (headerName) => req.get(headerName),\n      locals: res.locals,\n      next,\n      req,\n      res,\n      ...additionalParams,\n      simpleExpress,\n    });\n\n    try {\n      result = await handler(handlerParams);\n    } catch (error) {\n      return next(error);\n    }\n\n    if (result instanceof Error) {\n      return next(result);\n    }\n\n    const mappedResult = await chainPlugins(\n      plugins,\n      \"mapResponse\",\n      (previousResult) => !previousResult || previousResult.type === \"none\"\n    )(result, handlerParams);\n    sendResponse(req, res, mappedResult);\n  };\n\nexport const createErrorHandler =\n  ({ additionalParams = {}, plugins }, simpleExpress) =>\n  (handler) =>\n  async (error, req, res, next) => {\n    let result;\n\n    const handlerParams = await chainPlugins(\n      plugins,\n      \"getErrorHandlerParams\"\n    )({\n      body: req.body,\n      query: req.query,\n      // params: req.params, // params are reset before error handlers, for whatever reason: https://github.com/expressjs/express/issues/2117\n      method: req.method,\n      originalUrl: req.originalUrl,\n      protocol: req.protocol,\n      xhr: req.xhr,\n      get: req.get,\n      getHeader: (headerName) => req.get(headerName),\n      locals: res.locals,\n      next,\n      req,\n      res,\n      ...additionalParams,\n      simpleExpress,\n    });\n\n    try {\n      result = await handler(error, handlerParams);\n    } catch (error) {\n      return next(error);\n    }\n\n    if (result instanceof Error) {\n      return next(result);\n    }\n\n    const mappedResult = await chainPlugins(\n      plugins,\n      \"mapResponse\",\n      (previousResult) => !previousResult || previousResult.type === \"none\"\n    )(result, handlerParams);\n    sendResponse(req, res, mappedResult);\n  };\n\nexport default {\n  createErrorHandler,\n  createHandler,\n};\n","const ReactPropTypesSecret = \"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED\";\nconst has = Function.call.bind(Object.prototype.hasOwnProperty);\n\nconst getWarning = (text) => {\n  return text;\n  // var message = 'Warning: ' + text;\n  // if (typeof console !== 'undefined') {\n  //   console.error(message);\n  // }\n  // try {\n  //   // --- Welcome to debugging React ---\n  //   // This error was thrown as a convenience so that you can use this stack\n  //   // to find the callsite that caused this warning to fire.\n  //   throw new Error(message);\n  // } catch (x) { /**/ }\n};\n\nfunction checkPropTypes(typeSpecs, values, location, componentName, getStack) {\n  const errorMessages = [];\n\n  if (process.env.NODE_ENV !== \"production\") {\n    for (var typeSpecName in typeSpecs) {\n      if (has(typeSpecs, typeSpecName)) {\n        var error;\n        // Prop type validation may throw. In case they do, we don't want to\n        // fail the render phase where it didn't fail before. So we log it.\n        // After these have been cleaned up, we'll let them throw.\n        try {\n          // This is intentionally an invariant that gets caught. It's the same\n          // behavior as without this statement except with a better message.\n          if (typeof typeSpecs[typeSpecName] !== \"function\") {\n            var err = Error(\n              (componentName || \"React class\") +\n                \": \" +\n                location +\n                \" type `\" +\n                typeSpecName +\n                \"` is invalid; \" +\n                \"it must be a function, usually from the `prop-types` package, but received `\" +\n                typeof typeSpecs[typeSpecName] +\n                \"`.\" +\n                \"This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.\"\n            );\n            err.name = \"Invariant Violation\";\n            throw err;\n          }\n          error = typeSpecs[typeSpecName](\n            values,\n            typeSpecName,\n            componentName,\n            location,\n            null,\n            ReactPropTypesSecret\n          );\n        } catch (ex) {\n          error = ex;\n        }\n        if (error && !(error instanceof Error)) {\n          errorMessages.push(\n            getWarning(\n              (componentName || \"React class\") +\n                \": type specification of \" +\n                location +\n                \" `\" +\n                typeSpecName +\n                \"` is invalid; the type checker \" +\n                \"function must return `null` or an `Error` but returned a \" +\n                typeof error +\n                \". \" +\n                \"You may have forgotten to pass an argument to the type checker \" +\n                \"creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and \" +\n                \"shape all require an argument).\"\n            )\n          );\n        }\n        if (error instanceof Error) {\n          var stack = getStack ? getStack() : \"\";\n\n          errorMessages.push(\n            getWarning(\n              \"Failed \" +\n                location +\n                \" type: \" +\n                error.message +\n                (stack != null ? stack : \"\")\n            )\n          );\n        }\n      }\n    }\n  }\n\n  return errorMessages;\n}\n\nexport default checkPropTypes;\n","import _ from \"lodash\";\n\nconst validateErrorClass = (errorClass) => {\n  if (errorClass && !_.isFunction(errorClass)) {\n    throw new Error(\n      `handleError arguments error: expected constructor (e.g. Error class) but got ${typeof errorClass}`\n    );\n  }\n};\n\nconst validateHandler = (errorHandler) => {\n  if (!_.isFunction(errorHandler)) {\n    throw new Error(\n      `handleError arguments error: expected error handler function but got ${typeof errorHandler}`\n    );\n  }\n};\n\nconst getArgs = (args) => {\n  if (args.length === 1 && Array.isArray(args[0])) {\n    return args[0].reduce((accu, el) => {\n      if (!Array.isArray(el)) {\n        accu.push([null, el]);\n      } else if (el.length === 1) {\n        accu.push([null, el[0]]);\n      } else if (Array.isArray(el[0])) {\n        el[0].forEach((errorInstance) => {\n          accu.push([errorInstance, el[1]]);\n        });\n      } else {\n        accu.push(el);\n      }\n\n      return accu;\n    }, []);\n  }\n\n  if (args.length === 1) {\n    return [[null, args[0]]];\n  }\n\n  if (Array.isArray(args[0])) {\n    return args[0].map((errorInstance) => [errorInstance, args[1]]);\n  }\n\n  return [args];\n};\n\nconst handleError = ([errorClass, errorHandler]) => {\n  validateErrorClass(errorClass);\n  validateHandler(errorHandler);\n\n  return (error, handlerParams) => {\n    if (!errorClass || error instanceof errorClass) {\n      return errorHandler(error, handlerParams);\n    }\n    return error;\n  };\n};\n\nexport default (...args) => {\n  const errorHandlers = getArgs(args);\n\n  return errorHandlers.map(handleError);\n};\n","import http from \"http\";\nimport express from \"express\";\nimport cors from \"cors\";\nimport bodyParser from \"body-parser\";\nimport cookieParser from \"cookie-parser\";\nimport _ from \"lodash\";\n\nimport log from \"./log\";\nimport getStats from \"./stats\";\nimport buildRoutes from \"./buildRoutes\";\nimport { createHandler, createErrorHandler } from \"./createHandler\";\nimport propTypesMiddleware from \"./propTypesMiddleware\";\nimport handleError from \"./handleError.js\";\n\nexport const checkPropTypes = propTypesMiddleware;\n\nconst defaultAppValue = Symbol(\"defaultAppValue\");\nconst defaultServerValue = Symbol(\"defaultServerValue\");\n\nexport class ValidationError extends Error {\n  constructor(errors) {\n    super();\n    this.errors = errors;\n  }\n}\n\nconst getDefaultConfig = (\n  userConfig,\n  defaultConfig = {\n    cors: null,\n    jsonBodyParser: null,\n    cookieParser: [],\n  }\n) => {\n  if (!userConfig) {\n    return defaultConfig;\n  }\n\n  const {\n    cors = defaultConfig.cors,\n    jsonBodyParser = defaultConfig.jsonBodyParser,\n    cookieParser = defaultConfig.cookieParser,\n  } = userConfig;\n\n  return {\n    cors,\n    jsonBodyParser,\n    cookieParser,\n  };\n};\n\nconst createSimpleExpressHelper = ({ routes, routeParams }) => {\n  return {\n    runRoute: async (label, method, data) => {\n      if (!Array.isArray(routes)) {\n        log.warning(\n          `Only \"array of objects\" style routes are supported by runRoute helper`\n        );\n        return Promise.reject();\n      }\n      const route = _.find(routes, (route) => {\n        if (Array.isArray(route)) {\n          log.warning(\n            `Only \"array of objects\" style routes are supported by runRoute helper`\n          );\n          return Promise.reject();\n        }\n      });\n      if (!route) {\n        return Promise.reject();\n      }\n\n      const handler = _.get(route, [\"handler\", method]);\n      if (!handler) {\n        return Promise.reject();\n      }\n\n      return handler({ ...routeParams, ...data });\n    },\n    getRoutes: () => routes,\n  };\n};\n\nconst simpleExpress = async ({\n  port,\n  plugins: rawPlugins = [],\n  routes = [],\n  middleware = [],\n  middlewares, // TODO remove in 3.0.0\n  simpleExpressMiddlewares, // TODO remove in 3.0.0\n  globalMiddlewares, // TODO remove in 3.0.0\n  errorHandlers = [],\n  expressMiddlewares, // TODO remove in 3.0.0\n  expressMiddleware = [],\n  config: userConfig,\n  routeParams = {},\n  app: userApp = defaultAppValue,\n  server: userServer = defaultServerValue,\n} = {}) => {\n  if (port) {\n    log(`Initializing simpleExpress app on port ${port}...`);\n  } else {\n    log(`Initializing simpleExpress app (no port)...`);\n  }\n  // validate config\n  if (globalMiddlewares) {\n    log.warning(\n      '\"globalMiddlewares\" option is deprecated. Use \"middleware\" option.'\n    );\n    middleware = [...middleware, ...globalMiddlewares];\n  }\n  if (simpleExpressMiddlewares) {\n    log.warning(\n      '\"simpleExpressMiddlewares\" option is deprecated. Use \"middleware\" option.'\n    );\n    middleware = [...middleware, ...simpleExpressMiddlewares];\n  }\n  if (middlewares) {\n    log.warning(\n      '\"middlewares\" option is deprecated. Use \"middleware\" (without \"s\") option.'\n    );\n    middleware = [...middleware, ...middlewares];\n  }\n  if (expressMiddlewares) {\n    log.warning(\n      '\"expressMiddlewares\" option is deprecated. Use \"expressMiddleware\" (without \"s\") option.'\n    );\n    expressMiddleware = [...expressMiddleware, ...expressMiddlewares];\n  }\n\n  // simpleExpress config for plugins\n  const simpleExpressConfigForPlugins = {\n    port,\n    plugins: rawPlugins,\n    routes,\n    middleware,\n    errorHandlers,\n    expressMiddleware,\n    config: userConfig,\n    routeParams,\n    app: userApp,\n    server: userServer,\n  };\n\n  // preparePlugins\n  const plugins = rawPlugins.map((plugin) =>\n    plugin(simpleExpressConfigForPlugins)\n  );\n\n  // create stats\n  const stats = getStats(port);\n\n  // creating express app\n  const app = userApp === defaultAppValue ? express() : userApp;\n  const server =\n    userServer === defaultServerValue ? http.createServer(app) : userServer;\n  app.server = server;\n\n  // creating simpleExpress helper utility\n  const simpleExpressHelper = await createSimpleExpressHelper({\n    routes,\n    routeParams,\n  });\n\n  // applying default middlewares\n  const config = getDefaultConfig(userConfig);\n\n  if (config.cors !== false) {\n    stats.set(\"cors\");\n    app.use(cors(config.cors));\n  }\n\n  if (config.jsonBodyParser !== false) {\n    stats.set(\"jsonBodyParser\");\n    app.use(bodyParser.json(config.jsonBodyParser));\n  }\n\n  if (config.cookieParser !== false) {\n    stats.set(\"cookieParser\");\n    app.use(cookieParser(config.cookieParser));\n  }\n\n  const createHandlerWithParams = createHandler(\n    { additionalParams: routeParams, plugins },\n    simpleExpressHelper\n  );\n  const createErrorHandlerWithParams = createErrorHandler(\n    { additionalParams: routeParams, plugins },\n    simpleExpressHelper\n  );\n\n  // applying custom express middlewares\n  const expressMiddlewareFlat = _.flattenDeep(expressMiddleware);\n  stats.set(\"expressMiddleware\", expressMiddlewareFlat.length);\n  expressMiddlewareFlat.forEach((middleware) => app.use(middleware));\n\n  // applying middlewares\n  const middlewareFlat = _.flattenDeep(middleware);\n  stats.set(\"middleware\", middlewareFlat.length);\n  middlewareFlat.forEach((middleware) => {\n    app.use(createHandlerWithParams(middleware));\n  });\n\n  // applying routes\n  app.use(\n    buildRoutes({\n      app,\n      stats,\n      createHandlerWithParams,\n    })(routes)\n  );\n\n  // applying error handlers\n  const errorHandlersFlat = _.flattenDeep(errorHandlers);\n  stats.set(\"errorHandlers\", errorHandlersFlat.length);\n  errorHandlersFlat.forEach((errorHandler) => {\n    app.use(createErrorHandlerWithParams(errorHandler));\n  });\n\n  // starting actual server\n  if (port) {\n    app.server.listen(port);\n  }\n\n  if (port && !app.server.address()) {\n    log(\n      `ERROR: App started but app.server.address() is undefined. It seems that the ${port} port is already used.`\n    );\n    throw new Error(\n      `App started but it doesn't seem to listen on any port. Check if port ${port} is not already used.`\n    );\n  }\n\n  stats.logStartup();\n  if (port) {\n    log(`App is listening on port ${port}`);\n  } else {\n    log(`App started. Not listening on any port.`);\n  }\n\n  return { app, server, stats };\n};\n\nexport const wrapMiddleware = (...middleware) =>\n  _.flattenDeep(middleware).map((el) => ({ req, res, next }) => {\n    el(req, res, next);\n  });\n\nexport { handleError };\n\nexport default simpleExpress;\n","import { ValidationError } from \"./index\";\nimport checkPropTypes from \"./checkPropTypes\";\n\nconst propTypesMiddleware =\n  (rules) =>\n  ({ req, res, next }) => {\n    const method = req.method;\n    const path = req.originalUrl;\n    let errors = [];\n\n    if (rules.body) {\n      errors = [\n        ...errors,\n        ...checkPropTypes(\n          { body: rules.body },\n          { body: req.body },\n          \"value\",\n          `${method.toUpperCase()} ${path}`\n        ),\n      ];\n    }\n\n    if (rules.query) {\n      errors = [\n        ...errors,\n        ...checkPropTypes(\n          rules.query,\n          req.query,\n          \"query value\",\n          `${method.toUpperCase()} ${path}`\n        ),\n      ];\n    }\n\n    if (rules.params) {\n      errors = [\n        ...errors,\n        ...checkPropTypes(\n          rules.params,\n          req.params,\n          \"param\",\n          `${method.toUpperCase()} ${path}`\n        ),\n      ];\n    }\n\n    if (rules.cookies) {\n      errors = [\n        ...errors,\n        ...checkPropTypes(\n          rules.cookies,\n          req.cookies,\n          \"cookie\",\n          `${method.toUpperCase()} ${path}`\n        ),\n      ];\n    }\n\n    if (rules.headers) {\n      errors = [\n        ...errors,\n        ...checkPropTypes(\n          rules.headers,\n          req.headers,\n          \"header\",\n          `${method.toUpperCase()} ${path}`\n        ),\n      ];\n    }\n\n    if (errors.length) {\n      next(new ValidationError(errors));\n    }\n\n    next();\n  };\n\nexport default propTypesMiddleware;\n"],"sourceRoot":""}